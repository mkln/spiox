# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

Correlationc <- function(coordsx, coordsy, theta, matern, same) {
    .Call(`_spiox_Correlationc`, coordsx, coordsy, theta, matern, same)
}

dag_for_gridded_cols <- function(coords, m = 20L) {
    .Call(`_spiox_dag_for_gridded_cols`, coords, m)
}

daggp_build <- function(coords, dag, phi, sigmasq, nu, tausq, matern = 1L, num_threads = 1L, dag_opts = 0L) {
    .Call(`_spiox_daggp_build`, coords, dag, phi, sigmasq, nu, tausq, matern, num_threads, dag_opts)
}

iox <- function(x, y, i, j, S, theta, matern = TRUE, diag_only = FALSE, at_limit = FALSE) {
    .Call(`_spiox_iox`, x, y, i, j, S, theta, matern, diag_only, at_limit)
}

#' @title Scaling factor of IOX.
#' @description This function computes the scaling factor used to compute the cross-covariance at zero distance for IOX.
#'
#' @param dag an object returned from `spiox::dag_vecchia` or similar
#' @param S a matrix of reference coordinates
#' @param theta a matrix of dimension (4,q) where each column are the marginal covariance parameters of the corresponding variable
#' @param matern an integer. Options are 0: power exponential, 1: matern, 2: wave
#' @param n_threads integer number of threads for multi-threaded operations
#'
#' @return A matrix of dimension (q,q) filled in its lower-triangular portion. The (i,j) element is the scaling factor for \eqn{C_{ij}}.
#' The IOX cross-covariance at zero distance will be \eqn{Sigma_{ij}} multiplied by this scaling factor.
#'
#' @details The function is designed for computing the IOX scaling factor used to compute the cross-covariances \eqn{C_{ij}}.
#'
#' @export
sfact <- function(dag, S, theta, matern = 1L, n_threads = 1L) {
    .Call(`_spiox_sfact`, dag, S, theta, matern, n_threads)
}

Sigma_x_sfact_cpp <- function(dag, S, Sigma, theta, matern = 1L, n_threads = 1L) {
    .Call(`_spiox_Sigma_x_sfact_cpp`, dag, S, Sigma, theta, matern, n_threads)
}

make_ix <- function(q, n) {
    .Call(`_spiox_make_ix`, q, n)
}

iox_mat <- function(x, y, S, theta, matern = TRUE, D_only = FALSE) {
    .Call(`_spiox_iox_mat`, x, y, S, theta, matern, D_only)
}

MaxMincpp <- function(locations) {
    .Call(`_spiox_MaxMincpp`, locations)
}

S_to_Sigma <- function(S) {
    .Call(`_spiox_S_to_Sigma`, S)
}

S_to_Q <- function(S) {
    .Call(`_spiox_S_to_Q`, S)
}

Sigma_to_correl <- function(Sigma) {
    .Call(`_spiox_Sigma_to_correl`, Sigma)
}

Sigma_identify <- function(Sigma, theta) {
    .Call(`_spiox_Sigma_identify`, Sigma, theta)
}

spiox_response <- function(Y, X, coords, custom_dag, Beta_start, Sigma_start, Theta_start, mcmc = 1000L, print_every = 100L, matern = 1L, dag_opts = 0L, sample_Beta = TRUE, sample_Sigma = TRUE, update_Theta, num_threads = 1L) {
    .Call(`_spiox_spiox_response`, Y, X, coords, custom_dag, Beta_start, Sigma_start, Theta_start, mcmc, print_every, matern, dag_opts, sample_Beta, sample_Sigma, update_Theta, num_threads)
}

spiox_latent <- function(Y, X, coords, custom_dag, Beta_start, Sigma_start, Theta_start, Ddiag_start, mcmc = 1000L, print_every = 100L, matern = 1L, dag_opts = 0L, sample_Beta = TRUE, sample_Sigma = TRUE, sample_Ddiag = TRUE, update_Theta, num_threads = 1L, sampling = 2L) {
    .Call(`_spiox_spiox_latent`, Y, X, coords, custom_dag, Beta_start, Sigma_start, Theta_start, Ddiag_start, mcmc, print_every, matern, dag_opts, sample_Beta, sample_Sigma, sample_Ddiag, update_Theta, num_threads, sampling)
}

spiox_response_vi <- function(Y, X, coords, custom_dag, dag_opts, theta, Sigma_start, Beta_start, verbose = 0L, matern = 1L, num_threads = 1L) {
    .Call(`_spiox_spiox_response_vi`, Y, X, coords, custom_dag, dag_opts, theta, Sigma_start, Beta_start, verbose, matern, num_threads)
}

spiox_predict <- function(X_new, coords_new, Y, X, coords, dag, B, Sigma, theta, matern = 1L, num_threads = 1L) {
    .Call(`_spiox_spiox_predict`, X_new, coords_new, Y, X, coords, dag, B, Sigma, theta, matern, num_threads)
}

spiox_predict_part <- function(Y_new, X_new, coords_new, Y, X, coords, dag, B, Sigma, theta, matern = 1L, num_threads = 1L) {
    .Call(`_spiox_spiox_predict_part`, Y_new, X_new, coords_new, Y, X, coords, dag, B, Sigma, theta, matern, num_threads)
}

spiox_latent_predict <- function(X_new, coords_new, coords, dag, W, B, Sigma, Dvec, theta, matern = 1L, num_threads = 1L) {
    .Call(`_spiox_spiox_latent_predict`, X_new, coords_new, coords, dag, W, B, Sigma, Dvec, theta, matern, num_threads)
}

